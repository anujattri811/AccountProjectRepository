@model PablaAccountingAndTaxServicesEntity.ClientEntity
@{
    ViewBag.Title = "Client_Dashboard";
    Layout = "~/Views/Shared/_ClientLayout.cshtml";
}
@{
    var PersonName = new SelectList(ViewBag.PersonName, "Text", "Value");
}
<style>
    .table-custom th {
        padding: 5px 40px 4px !important;
    }
</style>
<section class="breadcrumbs-custom bg-image novi-background bg-primary">
    <div class="container">
        <ul class="breadcrumbs-custom-path">
            <li><a href="~/Client/client_login">Client</a></li>
            <li><a href="~/Client/client_dashboard">Client Dashboard</a></li>

        </ul>
    </div>
</section>
<section class="section section-lg bg-default" style="padding: 30px;">
    <div class="container">

        <div class="content-wrapper">
            <div class="row">
                <div class="col-xl-12">
                    <h5>Clients Dashboard</h5>
                    <!--Bootstrap tabs-->
                    <div class="tabs-custom tabs-horizontal tabs-corporate" id="tabs-1">
                        <!--Nav tabs-->
                        <ul class="nav nav-tabs">
                            <li class="nav-item" role="presentation"><a class="nav-link active show" id="LinkProfile" href="#tabs-1-1" data-toggle="tab">Profile</a></li>
                            <li class="nav-item" role="presentation"><a class="nav-link " href="#tabs-1-2" data-toggle="tab">Request Document</a></li>
                            <li class="nav-item" role="presentation"><a class="nav-link" href="#tabs-1-3" data-toggle="tab">View Requested Document</a></li>
                            <li class="nav-item" role="presentation"><a class="nav-link" id="LinkDocument" href="#tabs-1-4" data-toggle="tab">Documents</a></li>
                        </ul>
                        <!--Tab panes-->
                        <div class="tab-content">
                            <div class="tab-pane fade active show" id="tabs-1-1">
                                <div class="card-body">
                                    <div class="col-md-6" style="float:left;">
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>First Name</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">
                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.FirstName</label>
                                            </div>
                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Last Name</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.LastName</label>

                                            </div>


                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Phone</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.MobileNo</label>

                                            </div>


                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Email</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal">@Model.Email</label>

                                            </div>


                                        </div>
                                        <div class="form-row" style="margin-bottom:-10px">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>SIN</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.SIN</label>

                                            </div>


                                        </div>
                                        <div class="form-row form-group">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Date Of Birth</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.DateOfBirth</label>

                                            </div>


                                        </div>

                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Company Name</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.CompanyName</label>

                                            </div>


                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>GST Number</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.GSTNumber</label>

                                            </div>


                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Corporate Access Number</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.CorporateAccessNumber</label>

                                            </div>


                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>WCB</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.WCB</label>

                                            </div>


                                        </div>
                                    </div>

                                    <div class="col-md-6" style="float:left;">
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Address</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.Address</label>

                                            </div>
                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>City</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.City</label>

                                            </div>
                                        </div>

                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Province</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.Province</label>

                                            </div>

                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Country</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.Country</label>

                                            </div>

                                        </div>
                                        <div class="form-row" style="margin-bottom: -10px;">
                                            <div class="col-md-4 mb-3" style="padding-left:5px;">

                                                <label for="showEasing"><strong>Postal Code</strong></label>

                                            </div>
                                            <div class="col-md-6 mb-3" style="overflow:auto;">

                                                <label for="showEasing" style="width:100%;font-weight: normal!important">@Model.PostalCode</label>

                                            </div>

                                        </div>
                                        <a href="/Client/update_clientinfo?ClientId=@Model.UserId" class="button button-xs button-primary">Edit</a>

                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade " id="tabs-1-2">
                                <div class="container">
                                    <div class="row justify-content-md-center justify-content-xl-start">
                                        <div class="col-md-9 col-lg-7 col-xl-6">
                                            <h2 class="font-weight-normal">Request Document</h2>


                                            <form class="rd-form" action="\Client\RequestDocumentByClient" method="post" id="RequestedDocumentForm">
                                                <input type="hidden" id="UserId" value="@Model.UserId" name="UserId" />
                                                <div class="form-wrap form-group">
                                                    <select class="form-input form-control-has-validation" id="DocumentType" name="DocumentType" onchange="ShowOther()">
                                                        <option selected="" disabled="">Document Type</option>
                                                        <option>Notice Of Assessment</option>
                                                        <option>T1 General</option>
                                                        <option>T4's</option>
                                                        <option>T4 Summary</option>
                                                        <option>T5</option>
                                                        <option>Financials</option>
                                                        <option>T2</option>
                                                        <option>T2 Notice of Assessment</option>
                                                        <option>Paystubs</option>
                                                        <option>Schedule 100-125</option>
                                                        <option>PD7 A</option>
                                                        <option>Job letter</option>
                                                        <option>GST</option>
                                                        <option>Company Incorporation Papers</option>
                                                        <option>Other</option>
                                                    </select>
                                                </div>
                                                <div class="form-wrap" id="Show-OtherDocuments" style="display:none;">
                                                    <input type="text" name="OtherDocuments" id="OtherDocuments" class="form-input form-control-has-validation" />
                                                    <label class="form-label rd-input-label" for="OtherDocuments">Other Document</label>
                                                </div>
                                                <div class="form-wrap form-group" id="Show-years" style="display:none;">
                                                    <select class="form-input form-control-has-validation" id="PeriodTime" name="PeriodTime" onchange="Test()">
                                                        <option selected="" disabled="">Period Time</option>
                                                        <option>Monthly</option>
                                                        <option>Annualy</option>
                                                    </select>
                                                </div>
                                                <div class="form-wrap form-group" id="Show-months" style="display:none;">
                                                    <select class="form-input form-control-has-validation" name="Months">
                                                        <option selected="" disabled="">Select Month</option>
                                                        <option>January</option>
                                                        <option>Febuary</option>
                                                        <option>March</option>
                                                        <option>April</option>
                                                        <option>May</option>
                                                        <option>June</option>
                                                        <option>July</option>
                                                        <option>August</option>
                                                        <option>September</option>
                                                        <option>October</option>
                                                        <option>November</option>
                                                        <option>December</option>
                                                    </select>
                                                </div>
                                                <div class="form-wrap form-group" id="Year">
                                                    <select class="form-input form-control-has-validation" name="Year">
                                                        <option selected="" disabled="">Select Year</option>
                                                        <option>2011</option>
                                                        <option>2012</option>
                                                        <option>2013</option>
                                                        <option>2014</option>
                                                        <option>2015</option>
                                                        <option>2016</option>
                                                        <option>2017</option>
                                                        <option>2018</option>
                                                        <option>2019</option>
                                                        <option>2020</option>
                                                        <option>2021</option>
                                                        <option>2022</option>
                                                        <option>2023</option>
                                                        <option>2024</option>
                                                        <option>2025</option>
                                                        <option>2026</option>
                                                        <option>2027</option>
                                                        <option>2028</option>
                                                        <option>2029</option>
                                                        <option>2030</option>
                                                    </select>
                                                </div>
                                                <div class="form-wrap form-group">
                                                    @Html.DropDownList("PersonName", PersonName, "Select Person", new { @onchange = "ShowOtherPerson()", @class = "form-input form-control-has-validation" })
                                                </div>
                                                <div class="form-wrap" id="Show-OtherPersonName" style="display:none;">
                                                    <input type="text" name="OtherPersonName" id="OtherPersonName" class="form-input form-control-has-validation" />
                                                    <label class="form-label rd-input-label" for="OtherPersonName">Other Person</label>
                                                </div>
                                                <div class="form-wrap form-group">
                                                    <textarea class="form-input form-control-has-validation" name="Description" id="request-description"></textarea>
                                                    <label class="form-label rd-input-label" for="request-description">Description</label>
                                                </div>
                                                <div class="button-link-wrap text-right">
                                                    <button class="button button-primary" type="submit">Submit</button>
                                                </div>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="tab-pane fade" id="tabs-1-3">
                                <div class="table-custom-wrap table-custom-striped big">
                                    <div class="table-custom-responsive number-counter-2" style="overflow-x:scroll">
                                        <table id="Requestedexample1" class="table-custom">
                                            <thead>
                                                <tr>
                                                    <th>Operation</th>
                                                    <th>Status</th>
                                                    <th>Document Type</th>
                                                    <th>Other</th>
                                                    <th>Year</th>
                                                    <th>Person</th>
                                                    <th>Description</th>
                                                    <th>PeriodEnding</th>
                                                    <th>Monthly</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in ViewBag.Request)
                                                {

                                                    <tr>

                                                        @if (ViewBag.CurrentDays <= item.CreatedOn)
                                                        {
                                                            <td>
                                                                <a class="btn btn-danger btn-sm" href="#" onclick="Delete(@item.RequestDocumentId);">
                                                                    <i class="fas fa-trash">
                                                                    </i>
                                                                </a>
                                                            </td>

                                                        }
                                                        else
                                                        {
                                                            <td>-NA-</td>
                                                        }
                                                        @if (item.IsApprooved == true)
                                                        {
                                                            <td>
                                                                <div class="button button-xs button-primary" style="background:green;font-weight:bold;color:black;pointer-events:none;">Approved</div>
                                                            </td>

                                                            @*<td style="background:green;font-weight:bold;color:black;">Approved</td>*@
                                                        }
                                                        else if (item.IsDeclined == true)
                                                        {
                                                            <td>
                                                                <div class="button button-xs button-primary" style="background:red;font-weight:bold;color:black;pointer-events:none;">Declined</div>
                                                            </td>
                                                            @*<td style="background:red;font-weight:bold;color:black;">Declined</td>*@
                                                        }
                                                        else
                                                        {
                                                            <td>
                                                                <div class="button button-xs button-primary" style="background:yellow;font-weight:bold;color:black;pointer-events:none;">Pending</div>
                                                            </td>
                                                            @*<td style="background:yellow;font-weight:bold;color:black;">Pending</td>*@
                                                        }
                                                        <td>@item.DocumentType</td>
                                                        <td>@item.Other</td>
                                                        <td>@item.Year</td>
                                                        <td>@item.PersonName</td>
                                                        @if (item.Description.Length < 10)
                                                        {
                                                            <td title="@item.Description">@item.Description</td>
                                                        }
                                                        else
                                                        {
                                                            <td title="@item.Description">@item.Description.Substring(0, 10)...</td>
                                                        }
                                                        <td>@item.Periodending</td>
                                                        <td>@item.Monthly</td>

                                                    </tr>


                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="tab-pane fade" id="tabs-1-4">
                                <div class="table-custom-wrap table-custom-striped big">
                                    <div class="table-custom-responsive number-counter-2">
                                        @using (Html.BeginForm("client_dashboard", "Client", FormMethod.Get, new { enctype = "multipart/form-data" }))
                                        {
                                            <input type="hidden" name="ClientId" value="@Model.UserId" />
                                            <div class="col-md-12 row" style="margin-bottom:12px">
                                                <div class="form-wrap col-md-4" style="padding-top:10px;">
                                                    @Html.DropDownListFor(model => model.PersonName, PersonName, new { @class = "form-input form-control-has-validation" })
                                                </div>
                                                <div class="form-wrap col-md-4">
                                                    <select class="form-input form-control-has-validation" name="SearchDocumentType">
                                                        <option selected="" disabled="">Document Type</option>
                                                        <option>Notice Of Assessment</option>
                                                        <option>T1 General</option>
                                                        <option>T4's</option>
                                                        <option>T4 Summary</option>
                                                        <option>T5</option>
                                                        <option>Financials</option>
                                                        <option>T2</option>
                                                        <option>T2 Notice of Assessment</option>
                                                        <option>Paystubs</option>
                                                        <option>Schedule 100-125</option>
                                                        <option>PD7 A</option>
                                                        <option>Job letter</option>
                                                        <option>GST</option>
                                                        <option>Company Incorporation Papers</option>
                                                        <option>Other</option>
                                                    </select>
                                                </div>
                                                <div class="form-wrap  col-md-4" id="Year">
                                                    <select class="form-input form-control-has-validation" name="SearchYear">
                                                        <option selected="" disabled="">Select Year</option>
                                                        <option>2011</option>
                                                        <option>2012</option>
                                                        <option>2013</option>
                                                        <option>2014</option>
                                                        <option>2015</option>
                                                        <option>2016</option>
                                                        <option>2017</option>
                                                        <option>2018</option>
                                                        <option>2019</option>
                                                        <option>2020</option>
                                                        <option>2021</option>
                                                        <option>2022</option>
                                                        <option>2023</option>
                                                        <option>2024</option>
                                                        <option>2025</option>
                                                        <option>2026</option>
                                                        <option>2027</option>
                                                        <option>2028</option>
                                                        <option>2029</option>
                                                        <option>2030</option>
                                                    </select>
                                                </div>
                                                
                                            </div>
                                            <div class="col-md-12 row" style="margin-top:0px;margin-bottom:10px;">
                                                <div class="form-wrap col-md-4" style="margin-top:0px;margin-bottom:10px;">
                                                    <select class="form-input form-control-has-validation" name="SearchMonthly">
                                                        <option selected="" disabled="">Select Month</option>
                                                        <option>January</option>
                                                        <option>Febuary</option>
                                                        <option>March</option>
                                                        <option>April</option>
                                                        <option>May</option>
                                                        <option>June</option>
                                                        <option>July</option>
                                                        <option>August</option>
                                                        <option>September</option>
                                                        <option>October</option>
                                                        <option>November</option>
                                                        <option>December</option>
                                                    </select>
                                                </div>
                                                

                                                <div class="button-link-wrap text-right" style="margin-top:0px;margin-bottom:10px;">
                                                    <button class="button button-primary" type="submit">Search</button>
                                                </div>
                                            </div>
                                        }
                                        <table id="example1" class="table-custom">
                                            <thead>
                                                <tr>
                                                    <th>Operation</th>
                                                    <th>Person Name</th>
                                                    <th>Document Name</th>
                                                    <th>Document Type</th>
                                                    <th>Other</th>
                                                    <th>Year</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                @foreach (var item in ViewBag.TotalDocument)
                                                {
                                                    <tr>
                                                        <td class="text-gray-800">
                                                            <a href="~/Documents/@item.DocumentName.@item.Discription" target="_blank" style="margin:12px;"><span class="info-box-icon"><i class="fa fa-eye"></i></span></a>
                                                            <a href="~/Admin/DownloadFile?FileName=@item.DocumentName.@item.Discription" target="_blank" onclick="CloseLoader()"><span class="info-box-icon"><i class="fa fa-download"></i></span></a>
                                                        </td>
                                                        <td class="text-gray-800">@item.PersonName</td>
                                                        <td class="text-gray-800">@item.DocumentName</td>
                                                        <td class="text-gray-800">@item.DocumentType</td>
                                                        <td class="text-gray-800">@item.Other</td>
                                                        <td class="text-gray-800">@item.Year</td>
                                                    </tr>
                                                }
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>


</section>
<script src="~/Content/plugins/jquery/jquery.min.js"></script>
<script src="~/Content/plugins/bs-custom-file-input/bs-custom-file-input.min.js"></script>
<script src="~/Content/plugins/sweetalert2/SweetAlert.js"></script>

@*<script src="~/Content/plugins/jquery/jquery.min.js"></script>*@
<script src="~/Content/plugins/jquery-validation/jquery.validate.min.js"></script>

<script type="text/javascript">
    var myVar;
    function CloseLoader() {
        $(".preloader").fadeOut();
        $(".page").removeClass('fadeOut')
        myVar = setTimeout(CloseLoader, 500);
    }
    //$(function () {
    //    $("#example1").DataTable();
    //});

    $(document).ready(function () {
        bsCustomFileInput.init();
    });

    $(document).ready(function () {
        if ('@ViewBag.Search' == "1") {
            $("#LinkProfile").removeClass('active');
            $("#LinkProfile").removeClass('show');
            $("#tabs-1-1").removeClass('active');
            $("#tabs-1-1").removeClass('show');
            $("#LinkDocument").addClass('active');
            $("#LinkDocument").addClass('show');
             $("#tabs-1-4").addClass('active');
            $("#tabs-1-4").addClass('show');
        }
    })

    $( document ).ready(function() {
        if ('@TempData["Delete"]' == "1") {
        Swal.fire(
                    'Deleted!',
                    'Your Request has been deleted.',
                    'success'
                )
        }
});

    $(function () {
        $("#example1").DataTable();
    });
     $(function () {
        $("#Requestedexample1").DataTable();
    });
</script>
<script>
    $('#RequestedDocumentForm').validate({
        rules: {
            DocumentType: {
                required: true,
            },
            Year: {
                required: true,
            },
            PersonName: {
                required: true,
            },
            Description: {
                required: true,
            },
        },
        messages: {
            DocumentType: {
                required: "Please select Document Type.",
            },
            Year: {
                required: "Please select year.",
            },
            PersonName: {
                required: "Please select person name.",
            },
            Description: {
                required: "Please select description.",
            },
        },
        errorElement: 'span',
        errorPlacement: function (error, element) {
            error.addClass('invalid-feedback');
            element.closest('.form-group').append(error);
        },
        highlight: function (element, errorClass, validClass) {
            $(element).addClass('is-invalid');
        },
        unhighlight: function (element, errorClass, validClass) {
            $(element).removeClass('is-invalid');
        }
    });

    function ShowOther() {
        if ($("#DocumentType").val() == "Other") {
            $("#Show-OtherDocuments").fadeIn();
            $("#Show-years").fadeIn();
            $("#Year").fadeOut();

        }
        else {
            if ($("#DocumentType").val() == "Paystubs" || $("#DocumentType").val() == "PD7 A" || $("#DocumentType").val() == "GST") {
                $("#Show-years").fadeIn();
                $("#Show-OtherDocuments").fadeOut();
                $("#Year").fadeOut();
            }
            else {
                $("#Show-OtherDocuments").fadeOut();
                $("#Show-years").fadeOut();
                $("#Year").fadeIn();
            }

        }
    }
    function Test() {
        if ($("#PeriodTime").val() == "Monthly") {
            $("#Show-months").fadeIn();
            $("#Year").fadeOut();
        }
        else {
            $("#Show-months").fadeOut();
            $("#Year").fadeIn();
        }
    }

    function ShowOtherPerson() {
        if ($("#PersonName").val() == "Other") {
            $("#Show-OtherPersonName").fadeIn();
        }
        else {
            $("#Show-OtherPersonName").fadeOut();
        }
    }

    function Delete(UserId) {
        Swal.fire({
            title: 'Are you sure?',
            text: "You won't be able to revert this!",
            icon: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'Yes, delete it!'
        }).then((result) => {
            if (result.isConfirmed) {
                window.location.href = "/Client/DeleteRequest?UserId=" + UserId

            }
            else {
                Swal.fire(
                    'Cancelled',
                    'Your document is safe :)',
                    'error'
                )
            }
        })
    }
</script>
